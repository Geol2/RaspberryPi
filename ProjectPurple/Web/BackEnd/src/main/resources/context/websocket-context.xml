<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:websocket="http://www.springframework.org/schema/websocket"
	xmlns:context="http://www.springframework.org/schema/context"
	xsi:schemaLocation="http://www.springframework.org/schema/websocket http://www.springframework.org/schema/websocket/spring-websocket-4.1.xsd
		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.3.xsd">
	<!-- websocket handler mapping -->

	<!-- <beans:bean class="org.springframework.web.socket.server.standard.ServletServerContainerFactoryBean"> 
		<beans:property name="maxTextMessageBufferSize" value="8192"/> <beans:property 
		name="maxBinaryMessageBufferSize" value="8192"/> </beans:bean> -->

	<!-- <beans:bean id="webSocketHandler" class="com.spring.smart_plant.services.WebSocketHandler"/> -->

	<!-- <websocket:handlers allowed-origins="*"> <websocket:mapping handler="webSocketHandler" 
		path="/sensing_data" /> <websocket:handshake-interceptors> <beans:bean class="org.springframework.web.socket.server.support.HttpSessionHandshakeInterceptor"/> 
		</websocket:handshake-interceptors> <websocket:sockjs /> </websocket:handlers> -->
	
	<context:component-scan base-package="com.spring.smart_plant.common.service.websocket"/>

	<bean id="websocketHandler" class="com.spring.smart_plant.common.service.websocket.WebSocketHandler"/>

	<!-- 웹소켓만 -->
	<!-- <websocket:handlers order="20">
		<websocket:mapping handler="websocketHandler" path="/sensing_data"/>
		<websocket:handshake-interceptors>
			<bean class="org.springframework.web.socket.server.support.HttpSessionHandshakeInterceptor"></bean>
		</websocket:handshake-interceptors>		
	</websocket:handlers> -->

	<!-- SockJs -->
	<!-- <websocket:handlers order="30">
		<websocket:mapping handler="websocketHandler" path="/sensing_data"/>
		<websocket:handshake-interceptors>
			<bean class="org.springframework.web.socket.server.support.HttpSessionHandshakeInterceptor"></bean>
		</websocket:handshake-interceptors>
		<websocket:sockjs/>		
	</websocket:handlers> -->
	
	<!-- STOMP + SockJs -->
	<websocket:message-broker
		application-destination-prefix="/app" user-destination-prefix="/user" order="40">
		<websocket:stomp-endpoint path="/sensing_data" allowed-origins="*">
			<websocket:sockjs />
		</websocket:stomp-endpoint>
		<!-- <websocket:simple-broker prefix="/topic, /queue"/> -->
		<websocket:stomp-broker-relay prefix="/topic, /queue, /user"
			relay-host="${websocket.host}" relay-port="${websocket.port}" 
			client-login="${websocket.client.login}"
			client-passcode="${websocket.client.passcode}" 
			system-login="${websocket.system.login}" 
			system-passcode="${websocket.system.passcode}"
			/>
	</websocket:message-broker>

</beans>
